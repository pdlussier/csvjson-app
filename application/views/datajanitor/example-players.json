{"id":null,"date":"Wed, 09 Jan 2019 08:03:43 GMT","options":{"inputPageSize":5,"outputPageSize":5,"name":"Import Contacts in CRM","autoDetectHeader":true},"text":"No\tTeam\tFirst\tLast\tEmail\tCaptain\tMale/Female\n69\tFC LaTchass\tFelix\tLoxy\tfelix.loxy@example.com\tC\tMale\n7\tFC LaTchass\tJeanFrançois\tPiedmon\tjean françois.piedmon@example.com\t\tMale\n10\tFC LaTchass\tSebastien\tBernie\tsebastien.bernie@example.com\t\tMale\n1\tFC LaTchass\tToni\tDorvak\ttoni.dorvak@example.com\t\tMale\n3\tFC LaTchass\tRobin\tGantt\trobin.gantt@example.com\t\tMale\n\tFC LaTchass\tJulien\tWoody\tjulien.woody@example.com\t\tMale\n12\tFC LaTchass\tAntoine\tFortnite\tantoine.fortnite@example.com\t\tMale\n\tFC LaTchass\tTobie\tExcel\ttobie.excel@example.com\t\tMale\n\tFC LaTchass\tMike\tLaplace\tmike.laplace@example.com\t\tMale\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n10\tHrissa\tWassim\tBaoudi\twassim.baoudi@example.com\tC\tMale\n6\tHrissa\tHeithem\tTimbit\theithem.timbit@example.com\t\tMale\n7\tHrissa\tMourad\tLeMann\tmourad.lemann@example.com\t\tMale\n9\tHrissa\tRabeh\tAhoy\trabeh.ahoy@example.com\t\tMale\n1\tHrissa\tYassine\tSalam\tyassine.salam@example.com\t\tMale\n8\tHrissa\tAbdou\tTicheur\tabdou.ticheur@example.com\t\tMale\n5\tHrissa\tMarwen\tJordin\tmarwen.jordin@example.com\t\tMale\n4\tHrissa\tMeher\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n5\tFC Pointu\tClément\tMcTavish\tclément.mctavish@example.com\tC\tMale\n6\tFC Pointu\tRomain\tBraha\tromain.braha@example.com\t\tMale\n8\tFC Pointu\tVirgile \tWittman\tvirgile .wittman@example.com\t\tMale\n17\tFC Pointu\tJohn\tMomoa\tjohn.momoa@example.com\t\tMale\n16\tFC Pointu\tRami\tPlite\t\t\tMale\n1\tFC Pointu\tRicardo\tBackseat\tricardo.backseat@example.com\t\tMale\n3\tFC Pointu\tPier-Luc \tNicefield\tpier-luc .nicefield@example.com\t\tMale\n2\tFC Pointu\tMarc\tMiner\tmarc.miner@example.com\t\tMale\n13\tFC Pointu\tHicham \tBouboo\t\t\tMale\n21\tFC Pointu\tMorgan\tChatham\t\t\tMale\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\tLes Imbattables LSJ\tMoses\tIzouri\tmoses.izouri@example.com\tC\tMale\n\tLes Imbattables LSJ\tAntony \tPronovost\t\t\tMale\n\tLes Imbattables LSJ\tJosias\tMeghan\t\t\tMale\n\tLes Imbattables LSJ\tLouis Phillipe\tLego\t\t\tMale\n\tLes Imbattables LSJ\tOlivier\tBlanchard\t\t\tMale\n\tLes Imbattables LSJ\tSimon\tSambal\t\t\tMale\n\tLes Imbattables LSJ\tTony\tKing\t\t\tMale\n\tLes Imbattables LSJ\tMohamed \tSoup\t\t\tMale\n\tLes Imbattables LSJ\tIndrit\tBasmati\t\t\tMale\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n13\tRanging Lombrics\tTran\tVietname\ttran.vietname@example.com\tC\tMale\n8\tRanging Lombrics\tGeorge\tBorne\tgeorge.borne@example.com\t\tMale\n16\tRanging Lombrics\tAlain\tLi\talain.li@example.com\t\tMale\n3\tRanging Lombrics\tTran\tHo\ttran.ho@example.com\t\tMale\n7\tRanging Lombrics\tDanilo\tFrancisco\tdanilo.francisco@example.com\t\tMale\n11\tRanging Lombrics\tUlisce\tGregory\t\t\tMale\n5\tRanging Lombrics\tDaniel\tGiovani\tdaniel.giovani@example.com\t\tMale\n17\tRanging Lombrics\tMalik\t\tmalik.@example.com\t\tMale\n15\tRanging Lombrics\tSebastian\tEloi\tsebastian.eloi@example.com\t\tMale\n19\tRanging Lombrics\tAndres\tNonsense\tandres.nonsense@example.com\t\tMale\n1\tRanging Lombrics\tFred\t\t\t\tMale\n9\tRanging Lombrics\tJoel\tClancy\tjoel.clancy@example.com\t\tMale\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\tPassionTeam\tSamuel\tObama\tsamuel.obama@example.com\t\tMale\n\tPassionTeam\tEddy\tMurphy\teddy.murphy@example.com\t\tMale\n\tPassionTeam\tBen\tJapan\tben.japan@example.com\t\tMale\n\tPassionTeam\tJonathan\t?\t\t\tMale\n\tPassionTeam\tAndy\tMurdoch\tandy.murdoch@example.com\t\tMale\n\tPassionTeam\tAlex\tForbes\talex.forbes@example.com\t\tMale\n\tPassionTeam\tAurélien\tGrange\taurélien.grange@example.com\t\tMale\n\tPassionTeam\tEli\t\teli.@example.com\t\tMale\n\tPassionTeam\tVincent\tRupert\tvincent.rupert@example.com\t\tMale","code":"function cleanName(name) {\n  return (name||'').replace('?','').trim();\n}\nfunction process(input, columns) {\n  var output = [];\n  input.forEach(function(inRow, r) {\n    if (!inRow.First) return true;\n    var outRow = {};\n    \n    outRow['First Name'] = cleanName(inRow.First);\n    \n    // Last name is sometimes empty - use the first\n    outRow['Last Name'] = cleanName(inRow.Last) || outRow['First Name'];\n    \n    outRow.Gender = inRow[\"Male/Female\"] == 'Male' ? 'M' : 'F';\n    \n    // Dates are not provided but necessary - put whatever\n    outRow[\"Date of Birth\"] = '2000-01-01';\n    outRow[\"Join Date\"] = '2018-01-01';\n    \n    //if (!_.isEmail(inRow.Email)) throw 'Not an email ' + inRow.Email + ' on row ' + r;\n    outRow.email = inRow.Email || '';\n    \n    outRow.Activity = team2activity(inRow.Team);\n      \n    output.push(outRow);\n  });\n  return output;\n}\nfunction team2activity(team) {\n  var data = [{\"Activity\":\"Équipes Automne-Hiver 2018-2019::Futsal::Mercredi profutsal::FC LaTchass\",\"Team\":\"FC LaTchass\"},{\"Activity\":\"Équipes Automne-Hiver 2018-2019::Futsal::Mercredi profutsal::FC Pointu\",\"Team\":\"FC Pointu\"},{\"Activity\":\"Équipes Automne-Hiver 2018-2019::Futsal::Mercredi profutsal::Hrissa\",\"Team\":\"Hrissa\"},{\"Activity\":\"Équipes Automne-Hiver 2018-2019::Futsal::Mercredi profutsal::Les Imbattables LSJ\",\"Team\":\"Les Imbattables LSJ\"},{\"Activity\":\"Équipes Automne-Hiver 2018-2019::Futsal::Mercredi profutsal::PassionTeam mercredi profutsal\",\"Team\":\"PassionTeam\"},{\"Activity\":\"Équipes Automne-Hiver 2018-2019::Futsal::Mercredi profutsal::Raging Lombrics\",\"Team\":\"Ranging Lombrics\"}];\n  var o = _.findWhere(data, {Team:team});\n  return o ? o.Activity : '';\n}","request":{}}